<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ appTitle }}</title>
    <!-- Vue.js 3 -->
    <script src="https://cdn.jsdelivr.net/npm/vue@3.3.4/dist/vue.global.prod.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div id="app">
        <div :class="currentView === 'admin-dashboard' ? 'container-fluid' : 'container'">

            <!-- HEADER -->
            <header style="margin-bottom: 2rem; display: flex; justify-content: space-between; align-items: center;">
                <h1 style="margin: 0;">{{ appTitle }}</h1>
                <div>
                    <button v-if="currentView !== 'admin-login' && !isAdmin" @click="setView('admin-login')"
                        class="btn btn-secondary" style="font-size: 0.8rem;">ÁÆ°ÁêÜÂì°ÁôªÂÖ•</button>
                    <button v-if="currentView !== 'admin-dashboard' && isAdmin" @click="setView('admin-dashboard')"
                        class="btn btn-secondary" style="font-size: 0.8rem;">ÂõûÂà∞ÁÆ°ÁêÜÂæåÂè∞</button>
                    <button v-if="currentView !== 'resident-form'" @click="setView('resident-form')"
                        class="btn btn-secondary">ÂõûÈ¶ñÈ†Å</button>
                </div>
            </header>

            <!-- VIEW: RESIDENT FORM -->
            <div v-if="currentView === 'resident-form'" class="card">

                <div v-if="!isFormOpen" class="alert alert-error"
                    style="text-align: center; padding: 2rem; margin-bottom: 0;">
                    <h3 style="margin-bottom: 0.5rem;">‚õî ÁõÆÂâçÁ≥ªÁµ±Êö´ÂÅúÈñãÊîæÂ°´ÂØ´</h3>
                    <p>Ë´ãËÅØÁπ´ÁÆ°ÁêÜÂì°ÊàñÁ®çÂæåÂÜçË©¶„ÄÇ</p>
                </div>

                <div v-else>
                    <h2>‰ΩèÊà∂Ë≥áÊñôÂ°´ÂØ´</h2>
                    <p class="alert alert-info" style="background: #e0f2fe; color: #0369a1;">
                        Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑÊà∂ËôüÔºåÁ≥ªÁµ±Â∞áËá™ÂãïÂà§Êñ∑ÊòØÊñ∞Â¢ûÈÇÑÊòØÊõ¥Êñ∞Ë≥áÊñô„ÄÇ
                    </p>

                    <form @submit.prevent="submitResidentForm">
                        <div class="form-group">
                            <label>Êà∂Ëôü (ÂøÖÂ°´) <span style="color:red">*</span></label>
                            <input type="text" v-model="form.UnitNumber" placeholder="‰æãÂ¶Ç: 110-01F" required>
                        </div>

                        <div class="vehicle-group">
                            <h4>Á∑äÊÄ•ËÅØÁµ°‰∫∫</h4>
                            <div style="display: flex; gap: 1rem;">
                                <div class="form-group" style="flex: 3;">
                                    <label>ÂßìÂêç <span style="color:red">*</span></label>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <input type="text" v-model="form.ContactName" required style="flex: 1;">
                                        <select v-model="form.ContactSalutation"
                                            style="width: 100px; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.25rem; background: white;">
                                            <option value="ÂÖàÁîü">ÂÖàÁîü</option>
                                            <option value="Â•≥Â£´">Â•≥Â£´</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group" style="flex: 2;">
                                    <label>ËÅØÁµ°ÈõªË©± <span style="color:red">*</span></label>
                                    <input type="tel" v-model="form.ContactPhone" pattern="[0-9\-]*"
                                        placeholder="09xx-xxx-xxx" required>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="checkbox" v-model="form.IsRenter"
                                    style="width: auto; margin-right: 0.5rem;">
                                Á∑äÊÄ•ÈÄ£Áµ°‰∫∫ÈùûÂ±ã‰∏ª (Ex: ÁßüÂÆ¢)
                            </label>
                        </div>

                        <div class="vehicle-group" v-if="form.IsRenter"
                            style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                            <label
                                style="display: block; margin-bottom: 0.5rem; font-weight: bold; color: #4b5563;">Â±ã‰∏ªË≥áÊñô</label>
                            <div style="display: flex; gap: 1rem;">
                                <div class="form-group" style="flex: 3;">
                                    <label>ÂßìÂêç <span style="color:red">*</span></label>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <input type="text" v-model="form.OwnerName" style="flex: 1;" required>
                                        <select v-model="form.OwnerSalutation"
                                            style="width: 100px; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.25rem; background: white;">
                                            <option value="ÂÖàÁîü">ÂÖàÁîü</option>
                                            <option value="Â•≥Â£´">Â•≥Â£´</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group" style="flex: 2;">
                                    <label>ËÅØÁµ°ÈõªË©± <span style="color:red">*</span></label>
                                    <input type="tel" v-model="form.OwnerPhone" placeholder="09xx-xxx-xxx" required>
                                </div>
                            </div>
                        </div>

                        <hr style="margin: 1.5rem 0; border: 0; border-top: 1px solid #e5e7eb;">

                        <h3>ËªäËºõË≥áË®ä</h3>

                        <!-- Car Spot 1 -->
                        <div class="vehicle-group">
                            <h4>Ê±ΩËªä‰Ωç 1</h4>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label>Ëªä‰ΩçËôüÁ¢º</label>
                                    <input type="text" v-model="form.CarSpot1_Num" placeholder="‰æãÂ¶Ç: B1-01"
                                        pattern="[A-Z0-9]{2}-[0-9]{1,3}" maxlength="6">
                                </div>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" v-model="form.CarSpot1_IsRented">
                                        Ê≠§Ëªä‰ΩçÂá∫Áßü
                                    </label>
                                    <input v-if="form.CarSpot1_IsRented" type="text" v-model="form.CarSpot1_RenterUnit"
                                        placeholder="Âá∫ÁßüÊà∂Ëôü (ex: 112-08F)" :required="form.CarSpot1_IsRented">
                                </div>
                            </div>
                            <!-- Ëªä‰ΩçÂá∫ÁßüÊôÇÈö±ËóèËªäÁâå -->
                            <div class="grid-2" v-if="!form.CarSpot1_IsRented">
                                <div class="form-group">
                                    <label>ËªäÁâåËôüÁ¢º 1</label>
                                    <input type="text" v-model="form.CarSpot1_Plate1" placeholder="‰æãÂ¶Ç: ABC-1234"
                                        maxlength="10">
                                </div>
                                <div class="form-group">
                                    <label>ËªäÁâåËôüÁ¢º 2</label>
                                    <input type="text" v-model="form.CarSpot1_Plate2" placeholder="‰æãÂ¶Ç: XYZ-5678"
                                        maxlength="10">
                                </div>
                            </div>
                        </div>

                        <!-- Car Spot 2 -->
                        <div class="vehicle-group">
                            <h4>Ê±ΩËªä‰Ωç 2</h4>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label>Ëªä‰ΩçËôüÁ¢º</label>
                                    <input type="text" v-model="form.CarSpot2_Num" placeholder="‰æãÂ¶Ç: B1-02"
                                        pattern="[A-Z0-9]{2}-[0-9]{1,3}" maxlength="6">
                                </div>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" v-model="form.CarSpot2_IsRented">
                                        Ê≠§Ëªä‰ΩçÂá∫Áßü
                                    </label>
                                    <input v-if="form.CarSpot2_IsRented" type="text" v-model="form.CarSpot2_RenterUnit"
                                        placeholder="Âá∫ÁßüÊà∂Ëôü (ex: 110-01F)" :required="form.CarSpot2_IsRented">
                                </div>
                            </div>
                            <!-- Ëªä‰ΩçÂá∫ÁßüÊôÇÈö±ËóèËªäÁâå -->
                            <div class="grid-2" v-if="!form.CarSpot2_IsRented">
                                <div class="form-group">
                                    <label>ËªäÁâåËôüÁ¢º 1</label>
                                    <input type="text" v-model="form.CarSpot2_Plate1" placeholder="‰æãÂ¶Ç: ABC-1234"
                                        maxlength="10">
                                </div>
                                <div class="form-group">
                                    <label>ËªäÁâåËôüÁ¢º 2</label>
                                    <input type="text" v-model="form.CarSpot2_Plate2" placeholder="‰æãÂ¶Ç: XYZ-5678"
                                        maxlength="10">
                                </div>
                            </div>
                        </div>

                        <!-- Moto Spots 1-3 -->
                        <div v-for="i in 3" :key="'moto'+i" class="vehicle-group">
                            <h4>Ê©üËªä‰Ωç {{ i }}</h4>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label>Ëªä‰ΩçËôüÁ¢º</label>
                                    <input type="text" v-model="form['MotoSpot'+i+'_Num']" placeholder="‰æãÂ¶Ç: 01 Êàñ A01"
                                        maxlength="3">
                                </div>
                                <div class="form-group">
                                    <label>ËªäÁâåËôüÁ¢º</label>
                                    <input type="text" v-model="form['MotoSpot'+i+'_Plate']" placeholder="‰æãÂ¶Ç: NNN-1234"
                                        maxlength="10">
                                </div>
                            </div>
                        </div>

                        <hr style="margin: 1.5rem 0; border: 0; border-top: 1px solid #e5e7eb;">

                        <div class="form-group"
                            style="margin-bottom: 1.5rem; background: #fffbe6; padding: 1rem; border-radius: 8px; border: 1px solid #fcd34d;">
                            <label style="font-weight: bold; color: #92400e;">Á§æÂçÄ‰ª£Á¢º (È©óË≠âÁ¢º) <span
                                    style="color:red">*</span></label>
                            <input type="text" v-model="form.passcode" placeholder="Ë´ãËº∏ÂÖ•Á§æÂçÄÂÖ¨Âëä‰πã‰ª£Á¢º" required
                                style="font-size: 1.1rem; letter-spacing: 1px; border: 1px solid #fcd34d;">
                            <small style="color: #b45309;">ÁÇ∫Á¢∫‰øùË≥áÊñôÊ≠£Á¢∫ÊÄßÔºåË´ãËº∏ÂÖ•ÁÆ°ÁêÜÂÆ§Êèê‰æõÁöÑÈ©óË≠â‰ª£Á¢º„ÄÇ</small>
                        </div>

                        <div v-if="submitStatus.message"
                            :class="['alert', submitStatus.success ? 'alert-success' : 'alert-error']">
                            {{ submitStatus.message }}
                        </div>

                        <button type="submit" class="btn" :disabled="loading">
                            <span v-if="loading" class="spinner"></span>
                            {{ loading ? 'Ë≥áÊñôÂÇ≥ÈÄÅ‰∏≠...' : 'Êèê‰∫§Ë≥áÊñô' }}
                        </button>
                    </form>
                </div>
            </div>

            <!-- VIEW: ADMIN LOGIN -->
            <div v-if="currentView === 'admin-login'" class="card" style="max-width: 400px; margin: 0 auto;">
                <h2>ÁÆ°ÁêÜÂì°ÁôªÂÖ•</h2>
                <form @submit.prevent="adminLogin">
                    <!-- Honeypot for bots -->
                    <input type="text" v-model="loginForm.website" style="display:none;" autocomplete="off"
                        tabindex="-1">

                    <div class="form-group">
                        <label>Â∏≥Ëôü</label>
                        <input type="text" v-model="loginForm.username" required>
                    </div>
                    <div class="form-group">
                        <label>ÂØÜÁ¢º</label>
                        <input type="password" v-model="loginForm.password" required>
                    </div>

                    <div v-if="loginStatus.message" class="alert alert-error">
                        {{ loginStatus.message }}
                    </div>

                    <button type="submit" class="btn" style="width: 100%;" :disabled="loading">
                        <span v-if="loading" class="spinner"></span>
                        {{ loading ? 'ÁôªÂÖ•‰∏≠...' : 'ÁôªÂÖ•' }}
                    </button>
                </form>
            </div>

            <!-- VIEW: ADMIN DASHBOARD -->
            <div v-if="currentView === 'admin-dashboard'" class="card"
                style="width: 100%; border: none; box-shadow: none; background: transparent;">

                <!-- Main Admin Container -->
                <div
                    style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);">

                    <!-- Header Row -->
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; border-bottom: 1px solid #e5e7eb; padding-bottom: 1rem;">
                        <h2 style="margin: 0;">ÂæåËá∫ÁÆ°ÁêÜÁ≥ªÁµ± <span
                                style="color: gray; font-size: 0.6em; font-weight: normal;">(Headless Mode)</span>
                        </h2>

                        <div style="display: flex; align-items: center;">
                            <!-- Form Toggle Switch -->
                            <div v-if="adminRole === 'RW'"
                                style="margin-right: 1.5rem; display: flex; align-items: center;">
                                <span style="margin-right: 0.5rem; font-weight: bold; color: #4b5563;">‰ΩèÊà∂Â°´ÂØ´:</span>
                                <label class="switch">
                                    <input type="checkbox" v-model="isFormOpen" @change="toggleFormStatus">
                                    <span class="slider round"></span>
                                </label>
                                <span style="margin-left: 0.5rem; font-size: 0.9rem; font-weight: bold;"
                                    :style="{color: isFormOpen ? '#10b981' : '#ef4444'}">
                                    {{ isFormOpen ? 'ÈñãÊîæ‰∏≠' : 'Â∑≤ÈóúÈñâ' }}
                                </span>
                            </div>

                            <span v-if="currentUser"
                                :style="{ marginRight: '1rem', fontWeight: 'bold', color: adminRole === 'RW' ? '#7c3aed' : '#4b5563', background: adminRole === 'RW' ? '#f3e8ff' : '#f3f4f6', padding: '0.25rem 0.75rem', borderRadius: '9999px', fontSize: '0.9rem', border: adminRole === 'RW' ? '2px solid #a78bfa' : 'none' }">
                                {{ adminRole === 'RW' ? '‚≠ê' : 'üë§' }} {{ currentUser }}
                            </span>
                            <button @click="openChangePasswordModal" class="btn btn-secondary"
                                style="font-size: 0.9rem; margin-right: 0.5rem;">‰øÆÊîπÂØÜÁ¢º</button>
                            <button @click="logout" class="btn btn-danger" style="font-size: 0.9rem;">ÁôªÂá∫</button>
                        </div>
                    </div>

                    <!-- Tabs -->
                    <div style="display: flex; gap: 1rem; margin-bottom: 1rem; border-bottom: 2px solid #e5e7eb;">
                        <button @click="currentAdminTab = 'residents'"
                            :style="{ padding: '0.75rem 1.5rem', fontSize: '1.2rem', border: 'none', background: 'none', cursor: 'pointer', borderBottom: currentAdminTab === 'residents' ? '3px solid #2563eb' : 'none', fontWeight: currentAdminTab === 'residents' ? 'bold' : 'normal', color: currentAdminTab === 'residents' ? '#2563eb' : '#6b7280' }">
                            ‰ΩèÊà∂Ë≥áÊñôÁÆ°ÁêÜ
                        </button>
                        <button v-if="adminRole === 'RW'" @click="currentAdminTab = 'admins'"
                            :style="{ padding: '0.75rem 1.5rem', fontSize: '1.2rem', border: 'none', background: 'none', cursor: 'pointer', borderBottom: currentAdminTab === 'admins' ? '3px solid #2563eb' : 'none', fontWeight: currentAdminTab === 'admins' ? 'bold' : 'normal', color: currentAdminTab === 'admins' ? '#2563eb' : '#6b7280' }">
                            ÁÆ°ÁêÜÂì°Ë®≠ÂÆö
                        </button>
                    </div>

                    <!-- TAB: RESIDENTS -->
                    <div v-if="currentAdminTab === 'residents'">
                        <!-- QUICK FILTERS -->
                        <div style="margin-bottom: 1rem; display: flex; flex-wrap: wrap; gap: 0.5rem;">
                            <!-- "ÁÑ°" -> All -->
                            <button @click="setQuickFilter('All')" class="btn"
                                :style="{ background: currentFilter === 'All' ? '#6b7280' : '#f3f4f6', color: currentFilter === 'All' ? 'white' : '#374151', border: '1px solid #d1d5db' }">
                                ÁÑ°
                            </button>
                            <!-- Filter Buttons -->
                            <button v-for="prefix in ['110', '112', '116', '118', '120', '122', '126']" :key="prefix"
                                @click="setQuickFilter(prefix)" class="btn"
                                :style="{ background: currentFilter === prefix ? '#2563eb' : '#eff6ff', color: currentFilter === prefix ? 'white' : '#1e40af', border: '1px solid #bfdbfe' }">
                                {{ prefix }}
                                <span v-if="prefix==='110'">(A1)</span>
                                <span v-if="prefix==='112'">(A6)</span>
                                <span v-if="prefix==='116'">(A5)</span>
                                <span v-if="prefix==='118'">(A3)</span>
                                <span v-if="prefix==='120'">(A2)</span>
                                <span v-if="prefix==='122'">(A1)</span>
                                <span v-if="prefix==='126'">(A8)</span>
                            </button>
                        </div>

                        <div style="margin-bottom: 1rem; display: flex; gap: 0.5rem; align-items: center;">
                            <input type="text" v-model="searchQuery" placeholder="ÊêúÂ∞ã‰ΩèÊà∂ (Êà∂Ëôü/ÂßìÂêç/ÈõªË©±/ËªäÁâå)..."
                                style="max-width: 300px;">
                            <button @click="loadResidents" class="btn">ÈáçÊñ∞Êï¥ÁêÜ</button>
                            <button @click="clearFilters" class="btn btn-secondary"
                                style="border: 1px solid #d1d5db;">Ê∏ÖÈô§ÁØ©ÈÅ∏</button>
                            <span style="margin-left: auto; font-weight: bold; color: #4b5563;">
                                ÂÖ± {{ sortedResidents.length }} Á≠ÜË≥áÊñô
                            </span>
                        </div>

                        <div class="admin-table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th @click="setSort('UnitNumber')" style="cursor: pointer; user-select: none;">
                                            Êà∂Ëôü
                                            <span v-if="sortKey === 'UnitNumber'">{{ sortOrder === 1 ? '‚Üë' : '‚Üì'
                                                }}</span>
                                        </th>
                                        <th>ËÅØÁµ°Ë≥áË®ä</th>
                                        <th>Ë∫´‰ªΩ</th>
                                        <th>Â±ã‰∏ªË≥áË®ä</th>
                                        <th @click="setSort('Car')"
                                            style="min-width: 150px; cursor: pointer; user-select: none;">
                                            Ê±ΩËªä‰Ωç
                                            <span v-if="sortKey === 'Car'">{{ sortOrder === 1 ? '‚Üë' : '‚Üì' }}</span>
                                        </th>
                                        <th @click="setSort('Moto')"
                                            style="min-width: 150px; cursor: pointer; user-select: none;">
                                            Ê©üËªä‰Ωç
                                            <span v-if="sortKey === 'Moto'">{{ sortOrder === 1 ? '‚Üë' : '‚Üì' }}</span>
                                        </th>
                                        <th>Êìç‰Ωú</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-if="loading">
                                        <td colspan="7" style="text-align: center; padding: 2rem; color: #666;">
                                            <span class="spinner"></span> Ë≥áÊñôËºâÂÖ•‰∏≠...
                                        </td>
                                    </tr>
                                    <tr v-for="r in paginatedResidents" :key="r.UnitNumber" v-if="!loading">
                                        <td style="font-weight: bold;">{{ r.UnitNumber }}</td>
                                        <td>
                                            {{ r.ContactName }} {{ r.ContactSalutation }} {{
                                            formatPhone(r.ContactPhone)
                                            }}
                                        </td>
                                        <td>
                                            <span v-if="r.IsRenter === 'Yes' || r.OwnerName"
                                                style="color: #b45309; background: #ffedd5; padding: 2px 6px; border-radius: 4px;">ÈùûÂ±ã‰∏ª</span>
                                            <span v-else
                                                style="color: #059669; background: #d1fae5; padding: 2px 6px; border-radius: 4px;">Â±ã‰∏ª</span>
                                        </td>
                                        <td style="font-size: 0.9rem;">
                                            <div v-if="r.OwnerName">
                                                {{ r.OwnerName }} {{ r.OwnerSalutation }} {{
                                                formatPhone(r.OwnerPhone)
                                                }}
                                            </div>
                                            <span v-else style="color: #999;">-</span>
                                        </td>
                                        <!-- Ê±ΩËªä‰Ωç COL -->
                                        <td style="font-size: 0.9rem; vertical-align: top;">
                                            <div v-if="!r.CarSpot1_Num && !r.CarSpot2_Num" style="color: #ccc;">-
                                            </div>

                                            <div v-if="r.CarSpot1_Num"
                                                style="margin-bottom: 0.5rem; display: flex; align-items: baseline; flex-wrap: wrap;">
                                                <span style="font-weight: 500; margin-right: 0.5rem;">Ê±ΩËªä‰Ωç1</span>
                                                <span
                                                    style="background:#d1fae5; color:#059669; padding:2px 6px; border-radius:4px; font-weight:bold; font-size: 0.85rem; margin-right: 0.5rem;">
                                                    {{ r.CarSpot1_Num }}
                                                </span>
                                                <span v-if="r.CarSpot1_IsRented === 'Yes'" style="color: #d97706;">
                                                    (Áßü {{ r.CarSpot1_RenterUnit }})
                                                </span>
                                                <span v-else style="color: #4b5563;">
                                                    <span v-if="r.CarSpot1_Plate1">{{ r.CarSpot1_Plate1 }}</span>
                                                    <span v-if="r.CarSpot1_Plate1 && r.CarSpot1_Plate2"> / </span>
                                                    <span v-if="r.CarSpot1_Plate2">{{ r.CarSpot1_Plate2 }}</span>
                                                </span>
                                            </div>

                                            <div v-if="r.CarSpot2_Num"
                                                style="margin-bottom: 0.5rem; display: flex; align-items: baseline; flex-wrap: wrap;">
                                                <span style="font-weight: 500; margin-right: 0.5rem;">Ê±ΩËªä‰Ωç2</span>
                                                <span
                                                    style="background:#d1fae5; color:#059669; padding:2px 6px; border-radius:4px; font-weight:bold; font-size: 0.85rem; margin-right: 0.5rem;">
                                                    {{ r.CarSpot2_Num }}
                                                </span>
                                                <span v-if="r.CarSpot2_IsRented === 'Yes'" style="color: #d97706;">
                                                    (Áßü {{ r.CarSpot2_RenterUnit }})
                                                </span>
                                                <span v-else style="color: #4b5563;">
                                                    <span v-if="r.CarSpot2_Plate1">{{ r.CarSpot2_Plate1 }}</span>
                                                    <span v-if="r.CarSpot2_Plate1 && r.CarSpot2_Plate2"> / </span>
                                                    <span v-if="r.CarSpot2_Plate2">{{ r.CarSpot2_Plate2 }}</span>
                                                </span>
                                            </div>
                                        </td>
                                        <!-- Ê©üËªä‰Ωç COL -->
                                        <td style="font-size: 0.9rem; vertical-align: top;">
                                            <div v-if="!r.MotoSpot1_Num && !r.MotoSpot2_Num && !r.MotoSpot3_Num"
                                                style="color: #ccc;">-</div>

                                            <div v-if="r.MotoSpot1_Num"
                                                style="margin-bottom: 0.25rem; display: flex; align-items: baseline; flex-wrap: wrap;">
                                                <span style="font-weight: 500; margin-right: 0.5rem;">Ê©üËªä‰Ωç1</span>
                                                <span
                                                    style="background:#d1fae5; color:#059669; padding:2px 6px; border-radius:4px; font-weight:bold; font-size: 0.85rem; margin-right: 0.5rem;">
                                                    {{ r.MotoSpot1_Num }}
                                                </span>
                                                <span v-if="r.MotoSpot1_IsRented === 'Yes'" style="color: #d97706;">
                                                    (Áßü {{ r.MotoSpot1_RenterUnit }})
                                                </span>
                                                <span v-else style="color: #4b5563;">
                                                    {{ r.MotoSpot1_Plate }}
                                                </span>
                                            </div>

                                            <div v-if="r.MotoSpot2_Num"
                                                style="margin-bottom: 0.25rem; display: flex; align-items: baseline; flex-wrap: wrap;">
                                                <span style="font-weight: 500; margin-right: 0.5rem;">Ê©üËªä‰Ωç2</span>
                                                <span
                                                    style="background:#d1fae5; color:#059669; padding:2px 6px; border-radius:4px; font-weight:bold; font-size: 0.85rem; margin-right: 0.5rem;">
                                                    {{ r.MotoSpot2_Num }}
                                                </span>
                                                <span v-if="r.MotoSpot2_IsRented === 'Yes'" style="color: #d97706;">
                                                    (Áßü {{ r.MotoSpot2_RenterUnit }})
                                                </span>
                                                <span v-else style="color: #4b5563;">
                                                    {{ r.MotoSpot2_Plate }}
                                                </span>
                                            </div>

                                            <div v-if="r.MotoSpot3_Num"
                                                style="margin-bottom: 0.25rem; display: flex; align-items: baseline; flex-wrap: wrap;">
                                                <span style="font-weight: 500; margin-right: 0.5rem;">Ê©üËªä‰Ωç3</span>
                                                <span
                                                    style="background:#d1fae5; color:#059669; padding:2px 6px; border-radius:4px; font-weight:bold; font-size: 0.85rem; margin-right: 0.5rem;">
                                                    {{ r.MotoSpot3_Num }}
                                                </span>
                                                <span v-if="r.MotoSpot3_IsRented === 'Yes'" style="color: #d97706;">
                                                    (Áßü {{ r.MotoSpot3_RenterUnit }})
                                                </span>
                                                <span v-else style="color: #4b5563;">
                                                    {{ r.MotoSpot3_Plate }}
                                                </span>
                                            </div>
                                        </td>
                                        <td>
                                            <button v-if="adminRole === 'RW'" @click="deleteResident(r.UnitNumber)"
                                                class="btn btn-danger"
                                                style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">Âà™Èô§</button>
                                        </td>
                                    </tr>
                                    <tr v-if="!loading && paginatedResidents.length === 0">
                                        <td colspan="7" style="text-align: center; color: #666;">
                                            {{ searchQuery ? 'Êü•ÁÑ°Á¨¶ÂêàË≥áÊñô' : 'Â∞öÁÑ°Ë≥áÊñô' }}
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <!-- PAGINATION CONTROLS -->
                            <div v-if="totalPages > 1"
                                style="display: flex; justify-content: flex-end; align-items: center; gap: 1rem; padding: 1rem; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                                <button @click="currentPage--" :disabled="currentPage === 1"
                                    class="btn btn-secondary">‰∏ä‰∏ÄÈ†Å</button>
                                <span>Á¨¨ {{ currentPage }} È†Å / ÂÖ± {{ totalPages }} È†Å</span>
                                <button @click="currentPage++" :disabled="currentPage === totalPages"
                                    class="btn btn-secondary">‰∏ã‰∏ÄÈ†Å</button>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: ADMINS -->
                    <div v-if="currentAdminTab === 'admins'">
                        <div style="margin-bottom: 1rem;">
                            <button @click="showAddAdminModal = true" class="btn">Êñ∞Â¢ûÁÆ°ÁêÜÂì°</button>
                            <button @click="loadAdmins" class="btn btn-secondary"
                                style="margin-left: 0.5rem;">ÈáçÊñ∞Êï¥ÁêÜ</button>
                        </div>

                        <div class="admin-table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Â∏≥Ëôü</th>
                                        <th>‰∏äÊ¨°ÁôªÂÖ•</th>
                                        <th>Ê¨äÈôê</th>
                                        <th>ÁãÄÊÖã</th>
                                        <th>ÂÇôË®ª</th>
                                        <th>Êìç‰Ωú</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-if="adminsLoading">
                                        <td colspan="6" style="text-align: center; padding: 2rem; color: #666;">
                                            <span class="spinner"></span> Ë≥áÊñôËºâÂÖ•‰∏≠...
                                        </td>
                                    </tr>
                                    <tr v-for="admin in adminList" :key="admin.username" v-if="!adminsLoading">
                                        <td>{{ admin.username }}</td>
                                        <td>{{ admin.lastLogin }}</td>
                                        <td>
                                            <span v-if="admin.role === 'RW'" class="badge badge-success"
                                                style="background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 4px; font-size: 0.8rem;">ËÆÄÂØ´
                                                (RW)</span>
                                            <span v-else class="badge badge-secondary"
                                                style="background: #f3f4f6; color: #374151; padding: 2px 6px; border-radius: 4px; font-size: 0.8rem;">ÂîØËÆÄ
                                                (RO)</span>
                                        </td>
                                        <td>
                                            <span v-if="admin.lockedUntil && new Date(admin.lockedUntil) > new Date()"
                                                style="color:red; font-weight:bold; font-size: 0.9rem;">
                                                üîí Â∑≤ÈéñÂÆö
                                            </span>
                                            <span v-else style="color:green; font-size: 0.9rem;">Ê≠£Â∏∏</span>
                                        </td>
                                        <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis;">
                                            {{ admin.notes || '-' }}
                                        </td>
                                        <td>
                                            <button
                                                v-if="adminRole === 'RW' && admin.lockedUntil && new Date(admin.lockedUntil) > new Date()"
                                                @click="unlockAdmin(admin.username)" class="btn btn-primary"
                                                style="padding: 0.25rem 0.5rem; font-size: 0.8rem; margin-right: 0.25rem; background-color: #d97706;">Ëß£Èéñ</button>

                                            <button v-if="adminRole === 'RW'"
                                                @click="openResetPasswordModal(admin.username)"
                                                class="btn btn-secondary"
                                                style="padding: 0.25rem 0.5rem; font-size: 0.8rem; margin-right: 0.25rem;">ÈáçË®≠ÂØÜÁ¢º</button>
                                            <button v-if="adminRole === 'RW'" @click="openEditNotesModal(admin)"
                                                class="btn btn-secondary"
                                                style="padding: 0.25rem 0.5rem; font-size: 0.8rem; margin-right: 0.25rem;">Á∑®ËºØÂÇôË®ª</button>
                                            <button v-if="adminRole === 'RW' && admin.username !== 'admin'"
                                                @click="deleteAdmin(admin.username)" class="btn btn-danger"
                                                style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">Âà™Èô§</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MODAL: ADD ADMIN -->
            <div v-if="showAddAdminModal"
                style="position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 1000;">
                <div class="card" style="width: 350px;">
                    <h3>Êñ∞Â¢ûÁÆ°ÁêÜÂì°</h3>
                    <form @submit.prevent="createAdmin">
                        <div class="form-group">
                            <label>Â∏≥Ëôü</label>
                            <input type="text" v-model="newAdminForm.username" required>
                        </div>
                        <div class="form-group">
                            <label>ÂØÜÁ¢º</label>
                            <input type="password" v-model="newAdminForm.password" required>
                        </div>
                        <div class="form-group">
                            <label>Á¢∫Ë™çÂØÜÁ¢º</label>
                            <input type="password" v-model="newAdminForm.confirmPassword" required>
                        </div>
                        <div class="form-group">
                            <label>Ê¨äÈôê</label>
                            <select v-model="newAdminForm.role"
                                style="width: 100%; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
                                <option value="RW">ËÆÄÂØ´ (RW)</option>
                                <option value="RO">ÂîØËÆÄ (RO)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ÂÇôË®ªÔºàÈÅ∏Â°´Ôºâ</label>
                            <input type="text" v-model="newAdminForm.notes" placeholder="‰æãÂ¶ÇÔºö‰∏ªË¶ÅÁÆ°ÁêÜÂì°„ÄÅÊäÄË°ìÊîØÊè¥">
                        </div>

                        <div v-if="newAdminStatus.message"
                            :class="['alert', newAdminStatus.success ? 'alert-success' : 'alert-error']">
                            {{ newAdminStatus.message }}
                        </div>

                        <div style="display: flex; gap: 0.5rem;">
                            <button type="submit" class="btn">Á¢∫Ë™çÊñ∞Â¢û</button>
                            <button type="button" @click="showAddAdminModal = false"
                                class="btn btn-secondary">ÂèñÊ∂à</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- MODAL: CHANGE PASSWORD -->
            <div v-if="showPasswordModal"
                style="position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center;">
                <div class="card" style="width: 300px;">
                    <h3>‰øÆÊîπÂØÜÁ¢º</h3>
                    <form @submit.prevent="changePassword">
                        <div class="form-group">
                            <label>ËàäÂØÜÁ¢º</label>
                            <input type="password" v-model="pwdForm.oldPass" required>
                        </div>
                        <div class="form-group">
                            <label>Êñ∞ÂØÜÁ¢º</label>
                            <input type="password" v-model="pwdForm.newPass" required>
                        </div>
                        <div class="form-group">
                            <label>Á¢∫Ë™çÊñ∞ÂØÜÁ¢º</label>
                            <input type="password" v-model="pwdForm.confirmNewPass" required>
                        </div>

                        <div v-if="pwdStatus.message"
                            :class="['alert', pwdStatus.success ? 'alert-success' : 'alert-error']">
                            {{ pwdStatus.message }}
                        </div>

                        <div style="display: flex; gap: 0.5rem;">
                            <button type="submit" class="btn">Á¢∫Ë™ç‰øÆÊîπ</button>
                            <button type="button" @click="showPasswordModal = false"
                                class="btn btn-secondary">ÂèñÊ∂à</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- MODAL: RESET PASSWORD -->
            <div v-if="showResetPasswordModal"
                style="position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 1000;">
                <div class="card" style="width: 350px;">
                    <h3>ÈáçË®≠ÁÆ°ÁêÜÂì°ÂØÜÁ¢º</h3>
                    <p style="color: #666; font-size: 0.9rem;">ÁÆ°ÁêÜÂì°: <strong>{{ resetPasswordForm.targetUsername
                            }}</strong>
                    </p>
                    <form @submit.prevent="resetAdminPassword">
                        <div class="form-group">
                            <label>Êñ∞ÂØÜÁ¢º</label>
                            <input type="password" v-model="resetPasswordForm.newPassword" required>
                        </div>
                        <div class="form-group">
                            <label>Á¢∫Ë™çÊñ∞ÂØÜÁ¢º</label>
                            <input type="password" v-model="resetPasswordForm.confirmPassword" required>
                        </div>

                        <div v-if="resetPasswordStatus.message"
                            :class="['alert', resetPasswordStatus.success ? 'alert-success' : 'alert-error']">
                            {{ resetPasswordStatus.message }}
                        </div>

                        <div style="display: flex; gap: 0.5rem;">
                            <button type="submit" class="btn">Á¢∫Ë™çÈáçË®≠</button>
                            <button type="button" @click="showResetPasswordModal = false"
                                class="btn btn-secondary">ÂèñÊ∂à</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- MODAL: EDIT NOTES -->
            <div v-if="showEditNotesModal"
                style="position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 1000;">
                <div class="card" style="width: 400px;">
                    <h3>Á∑®ËºØÁÆ°ÁêÜÂì°ÂÇôË®ª</h3>
                    <p style="color: #666; font-size: 0.9rem;">ÁÆ°ÁêÜÂì°: <strong>{{ editNotesForm.targetUsername
                            }}</strong>
                    </p>
                    <form @submit.prevent="updateAdminNotes">
                        <div class="form-group">
                            <label>ÂÇôË®ª</label>
                            <textarea v-model="editNotesForm.notes" rows="4"
                                style="width: 100%; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem; font-family: inherit;"
                                placeholder="Ëº∏ÂÖ•ÁÆ°ÁêÜÂì°ÂÇôË®ªË≥áË®ä..."></textarea>
                        </div>

                        <div v-if="editNotesStatus.message"
                            :class="['alert', editNotesStatus.success ? 'alert-success' : 'alert-error']">
                            {{ editNotesStatus.message }}
                        </div>

                        <div style="display: flex; gap: 0.5rem;">
                            <button type="submit" class="btn">Á¢∫Ë™çÊõ¥Êñ∞</button>
                            <button type="button" @click="showEditNotesModal = false"
                                class="btn btn-secondary">ÂèñÊ∂à</button>
                        </div>
                    </form>
                </div>
            </div>

        </div>

        <!-- Scripts -->
        <script src="js/main.js"></script>
</body>

</html>